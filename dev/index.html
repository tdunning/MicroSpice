<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · MicroSpice.jl</title><meta name="title" content="Home · MicroSpice.jl"/><meta property="og:title" content="Home · MicroSpice.jl"/><meta property="twitter:title" content="Home · MicroSpice.jl"/><meta name="description" content="Documentation for MicroSpice.jl."/><meta property="og:description" content="Documentation for MicroSpice.jl."/><meta property="twitter:description" content="Documentation for MicroSpice.jl."/><meta property="og:url" content="https://tdunning.github.io/MicroSpice.jl/"/><meta property="twitter:url" content="https://tdunning.github.io/MicroSpice.jl/"/><link rel="canonical" href="https://tdunning.github.io/MicroSpice.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>MicroSpice.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Running-a-Simulation"><span>Running a Simulation</span></a></li><li><a class="tocitem" href="#Circuit-parameters"><span>Circuit parameters</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/tdunning/MicroSpice.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/tdunning/MicroSpice.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="MicroSpice"><a class="docs-heading-anchor" href="#MicroSpice">MicroSpice</a><a id="MicroSpice-1"></a><a class="docs-heading-anchor-permalink" href="#MicroSpice" title="Permalink"></a></h1><p><a href="https://github.com/tdunning/MicroSpice.jl">MicroSpice</a> is a very simple circuit simulator that simulates an electronic circuit composed a variety of passive components. This circuit can be constructed using a subset of standard Spice netlist syntax.</p><p>As an example, here is a simple RLC circuit with <code>in</code> as input and <code>out</code> as output</p><pre><code class="nohighlight hljs">L1 in  out 100nH
R1 out gnd  50Ω
C1 out gnd 100nF</code></pre><p>Currently the only supported components are resistors (R), inductors (L) and capacitors (C). Component values can be specified using standard SI prefixes such as <code>k</code> (kilo = 1e3), <code>M</code> (Mega=1e6), <code>G</code>(giga=1e9), <code>m</code> (milli=1e-3), <code>μ</code> (micro=1e-6), <code>n</code> (nano=1e-9), or <code>p</code> (pico=1e-12). In addition, the non-standard forms <code>u</code> (micro=1e-6) and <code>meg</code> (Mega=1e6) are used for Spice compatibility.</p><p>Units including H (Henry), F (Farad) and Ω (ohm) are allowed, but are optional, but the unit must match the type of component.</p><p>Component values can also be a reference to a parameter. For instance, we could modify the circuit above to parameterize the value of the inductor and capacitor:</p><pre><code class="nohighlight hljs">L1 in  out $L
R1 out gnd  50Ω
C1 out gnd $C</code></pre><p>More on how to use this <a href="#Circuit-parameters">later</a></p><h2 id="Running-a-Simulation"><a class="docs-heading-anchor" href="#Running-a-Simulation">Running a Simulation</a><a id="Running-a-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Running-a-Simulation" title="Permalink"></a></h2><p>A <code>Netlist</code> describes an abstract circuit. To simulate that circuit, the circuit is turned into a matrix equation consisting of complex admittances that relate the voltages and currents in the circuit. In this conversion, the voltages for any subset of nodes can be forced and currents can be injected into any nodes that are not forced to a particular voltage. The result of the voltages and all of the node-to-node currents are then computed.</p><p>In normal practice, the internals of this conversion are hidden from view. All you need to do is provide a <code>Netlist</code> and a list of inputs and outputs and you get a simulation function that takes a frequency, a vector of voltages and returns a vector of output voltages. You can call that simulation function repeatedly for different frequencies or different inputs.</p><p>Taking the circuit given above, if we take node <code>in</code> as the input, node <code>out</code> as the output and <code>gnd</code> as the ground reference, we can simulate the voltage transfer function for this circuit with this code:</p><pre><code class="language-julia hljs">using MicroSpice
nl = MicroSpice.Netlist(&quot;L1 in  out 100nH\nR1 out gnd 50Ω\nC1 out gnd 100nF\n&quot;)
s = MicroSpice.solve(nl, [:in, :gnd], [&quot;out&quot;])
decibel(x) = 20 * log10(abs(x))
[decibel(only(s(f, [1, 0]))) for f in [1.4e6, 1.5e6, 1.62e6, 1.8e6]]
# output
4-element Vector{Float64}:
 12.883077832402897
 18.914298710446417
 27.65586909592151
 11.05634871505561</code></pre><h2 id="Circuit-parameters"><a class="docs-heading-anchor" href="#Circuit-parameters">Circuit parameters</a><a id="Circuit-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Circuit-parameters" title="Permalink"></a></h2><p>If you have component values that are parameter references (such as <code>$L</code> in the example above), the values of the parameters must be supplied when you run the actual simulation function. Even before that, though, when you construct the <code>Netlist</code>, you need to provide the names of the parameters that you will be providing later as a list. This list also specifies the order in which you will provide the values later.</p><p>Here is an example with the circuit from before but with parameters for the inductor and capacitor. Note the use of a raw string to avoid needing to quote the <code>$</code> before the parameter names.</p><pre><code class="language-julia hljs">using MicroSpice
nl = MicroSpice.Netlist(raw&quot;&quot;&quot;
L1 in  out $L
R1 out gnd 50Ω
C1 out gnd $C
&quot;&quot;&quot;, [&quot;L&quot;, &quot;C&quot;])
decibel(x) = 20 * log10(abs(x))
[ 
decibel(only(MicroSpice.solve(nl, [:in, :gnd], [&quot;out&quot;], params)(f, [1, 0])))
for f in  [1.0e6, 1.2e6, 1.4e6, 1.62e6, 1.8e6, 2.0e6],
params in  [[100e-9, 100e-9], [200e-9, 50e-9], [120e-9, 100e-9]]
]
# output
6×3 Matrix{Float64}:
  4.35992   4.35431   5.57245
  7.29487   7.279     9.94251
 12.8831   12.8055   22.5545
 27.6559   25.2887   12.2341
 11.0563   10.9722    5.42304
  4.73621   4.71178   0.958959</code></pre><ul><li><a href="#MicroSpice.ComplexCircuit"><code>MicroSpice.ComplexCircuit</code></a></li><li><a href="#MicroSpice.InternalExpression"><code>MicroSpice.InternalExpression</code></a></li><li><a href="#MicroSpice.Link"><code>MicroSpice.Link</code></a></li><li><a href="#MicroSpice.Netlist"><code>MicroSpice.Netlist</code></a></li><li><a href="#MicroSpice.Netlist"><code>MicroSpice.Netlist</code></a></li><li><a href="#MicroSpice.coil-Tuple{Any, Any, Any}"><code>MicroSpice.coil</code></a></li><li><a href="#MicroSpice.inputImpedance-Tuple{MicroSpice.Netlist, Any, Any}"><code>MicroSpice.inputImpedance</code></a></li><li><a href="#MicroSpice.solve-Tuple{MicroSpice.ComplexCircuit, Any, Any}"><code>MicroSpice.solve</code></a></li><li><a href="#MicroSpice.solve"><code>MicroSpice.solve</code></a></li><li><a href="#MicroSpice.xc-Tuple{Any, Any}"><code>MicroSpice.xc</code></a></li><li><a href="#MicroSpice.xl-Tuple{Any, Any}"><code>MicroSpice.xl</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroSpice.ComplexCircuit" href="#MicroSpice.ComplexCircuit"><code>MicroSpice.ComplexCircuit</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A circuit is defined as a set of nodes connected by admittances. Each node may be set to a particular voltage, or can have a current injected or it can be free-floating. This is modeled as a linear system of equations  in terms of the <code>n</code> nodal voltages of which <code>m</code> are externally constrained,  and <code>k</code> injected currents. The first <code>n</code> of these equations define  the relationship between node voltages and injected currents and are of rank <code>n-1</code>. The next <code>m</code> equations define externally set voltages  followed by <code>k</code> equations for injected currents. We assume that imposed voltages and injected currents are on different nodes so this gives a rank of <code>n + m + k - 1</code> so far. There are an additional <code>n-m-k</code> equations that set all remaining injected currents to zero and a final constraint that sets the sum of all injected currents to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tdunning/MicroSpice.jl/blob/17ebb95547b1fcf87fec11a20b1c20f334c77164/src/MicroSpice.jl#L117-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroSpice.InternalExpression" href="#MicroSpice.InternalExpression"><code>MicroSpice.InternalExpression</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>An InternalExpression is a sum of a numerical value and references into a value vector that will be provided at simulation time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tdunning/MicroSpice.jl/blob/17ebb95547b1fcf87fec11a20b1c20f334c77164/src/MicroSpice.jl#L16-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroSpice.Link" href="#MicroSpice.Link"><code>MicroSpice.Link</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A Link is a composite of pure resistance, inductance and capacitance arranged in parallel. </p><p>To simplify combining multiple links, resistance and inductance are  retained in inverse form (i.e. 1/R, 1/L).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tdunning/MicroSpice.jl/blob/17ebb95547b1fcf87fec11a20b1c20f334c77164/src/MicroSpice.jl#L73-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroSpice.Netlist" href="#MicroSpice.Netlist"><code>MicroSpice.Netlist</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A netlist is defined as a set of nodes which are connected by ideal resistors, inductors and capacitors. Such a netlist can be resolved into a ComplexCircuit at any desired frequency by replacing the inductors and capacitors by their equivalent  complex impedances at that frequency.</p><p>Constructs a Netlist from a Spice circuit. As an example, here  is a simple RLC circuit with <code>in</code> as input and <code>out</code> as output</p><pre><code class="nohighlight hljs">L1 in  out 100nH
R1 out gnd  50Ω
C1 out gnd 100nF</code></pre><p>Currently the only supported components are resistors (R), inductors (L) and capacitors (C). Component values can be specified using standard SI prefixes such as <code>k</code> (kilo = 1e3),  <code>M</code> (Mega=1e6), <code>G</code>(giga=1e9), <code>m</code> (milli=1e-3), <code>μ</code> (micro=1e-6),  <code>n</code> (nano=1e-9), or <code>p</code> (pico=1e-12). In addition, the non-standard  forms <code>u</code> (micro=1e-6) and <code>meg</code> (Mega=1e6) are used for Spice compatibility.</p><p>Units including H (Henry), F (Farad) and Ω (ohm) are allowed, but  are optional, but only the correct unit type is allowed.f</p><p>A Netlist can be converted to a ComplexCircuit at a specific frequency and then solved with specified input voltages and currents to find the voltages for all nodes in the circuit. Taking the example above,  we can find the response for a few frequencies using this  code</p><pre><code class="language-julia hljs">nl = MicroSpice.Netlist(&quot;L1 in  out 100n
R1 out gnd 50
C1 out gnd 100n
&quot;)
s = MicroSpice.solve(nl, [:in, :gnd], [:out])
decibel(x) = 20 * log10(abs(x))
[decibel(only(s(f, [1, 0]))) for f in [1.4e6, 1.5e6, 1.62e6, 1.8e6]]
# output
4-element Vector{Float64}:
 12.883077832402897
 18.914298710446417
 27.65586909592151
 11.05634871505561</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tdunning/MicroSpice.jl/blob/17ebb95547b1fcf87fec11a20b1c20f334c77164/src/MicroSpice.jl#L137-L182">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroSpice.Netlist" href="#MicroSpice.Netlist"><code>MicroSpice.Netlist</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Reads some input and parses that input as a netlist</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tdunning/MicroSpice.jl/blob/17ebb95547b1fcf87fec11a20b1c20f334c77164/src/MicroSpice.jl#L182-L184">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroSpice.coil-Tuple{Any, Any, Any}" href="#MicroSpice.coil-Tuple{Any, Any, Any}"><code>MicroSpice.coil</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Inductance in nH of a coil with n turns d mm in diameter and l mm long</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tdunning/MicroSpice.jl/blob/17ebb95547b1fcf87fec11a20b1c20f334c77164/src/MicroSpice.jl#L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroSpice.inputImpedance-Tuple{MicroSpice.Netlist, Any, Any}" href="#MicroSpice.inputImpedance-Tuple{MicroSpice.Netlist, Any, Any}"><code>MicroSpice.inputImpedance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Returns a function that takes a frequency and computes the impedance of a circuit from the specified input to the specified reference (ground) node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tdunning/MicroSpice.jl/blob/17ebb95547b1fcf87fec11a20b1c20f334c77164/src/MicroSpice.jl#L227-L232">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroSpice.solve" href="#MicroSpice.solve"><code>MicroSpice.solve</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Returns a function that simulates a circuit with specified voltage inputs and outputs. That function takes as arguments the frequency and a list of input voltages and it returns a list of output voltages.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tdunning/MicroSpice.jl/blob/17ebb95547b1fcf87fec11a20b1c20f334c77164/src/MicroSpice.jl#L212-L216">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroSpice.solve-Tuple{MicroSpice.ComplexCircuit, Any, Any}" href="#MicroSpice.solve-Tuple{MicroSpice.ComplexCircuit, Any, Any}"><code>MicroSpice.solve</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute the voltages and injected currents for each node.</p><p>The input is a list of <span>$(i, V_i)$</span> pairs which represent the imposed voltages and a list of injected currents as <span>$(i, I_i)$</span>. The nodes with imposed voltages should not overlap with the nodes with injected currents. All nodes without an imposed voltage are considered free-floating and their voltage level will be computed. Nodes with no injected current are considered isolated except for the connections specified in the connections in the circuit.</p><p>The result is a vector of node voltages and injected currents <span>$[V_1 \ldots V_n, I_1 \ldots I_n]$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tdunning/MicroSpice.jl/blob/17ebb95547b1fcf87fec11a20b1c20f334c77164/src/MicroSpice.jl#L303-L317">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroSpice.xc-Tuple{Any, Any}" href="#MicroSpice.xc-Tuple{Any, Any}"><code>MicroSpice.xc</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Complex reactance of a capacitor at a given frequency</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tdunning/MicroSpice.jl/blob/17ebb95547b1fcf87fec11a20b1c20f334c77164/src/MicroSpice.jl#L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroSpice.xl-Tuple{Any, Any}" href="#MicroSpice.xl-Tuple{Any, Any}"><code>MicroSpice.xl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Complex reactance of an inductor at a given frequency</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tdunning/MicroSpice.jl/blob/17ebb95547b1fcf87fec11a20b1c20f334c77164/src/MicroSpice.jl#L10">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Sunday 10 November 2024 23:56">Sunday 10 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
